<div class="root">
  <div class="header">
    <div class="header-links">
      <span class="header-link version-tag" nz-tooltip nzTooltipTitle="当前版本">
        v{{ version }}
      </span>
      <a href="https://github.com/wh131462/ngx-floating" target="_blank" class="header-link" nz-tooltip
         nzTooltipTitle="GitHub仓库">
        <i nz-icon nzType="github" nzTheme="outline"></i>
      </a>
      <a href="https://www.npmjs.com/package/ngx-floating" target="_blank" class="header-link" nz-tooltip
         nzTooltipTitle="NPM包">
        <i nz-icon nzType="code-sandbox" nzTheme="outline"></i>
      </a>
    </div>
    <div class="header-content">
      <h1>NGX-FLOATING</h1>
      <p class="desc">A lightweight and powerful Angular floating UI solution</p>
    </div>
  </div>
  <nz-tabset [(nzSelectedIndex)]="selectedTabIndex">
    <nz-tab nzTitle="基础组件">
      <nz-card class="demo-card">
        <section class="example">
          <div class="example-title">
            <h3>基础组件用法</h3>
            <span class="code-toggle" (click)="toggleCode('basic')">
              <i nz-icon [nzType]="showCodeMap['basic'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['basic']">
            <div class="range" #at1>
              <ngx-floating [at]="at1" [boundary]="at1" [movable]="true"
                            [offset]="{ right: 10, bottom: 10, inner: true}">
                <div class="box">可移动的浮动框</div>
              </ngx-floating>
            </div>
          </div>
          @if (showCodeMap['basic']) {
            <div class="example-code">
              <nz-code-editor [ngModel]="codeMap['basic']" [nzEditorOption]="{readOnly: true}"></nz-code-editor>
            </div>
          }
        </section>
        <section class="example">
          <div class="example-title">
            <h3>拖拽句柄用法</h3>
            <span class="code-toggle" (click)="toggleCode('handler')">
      <i nz-icon [nzType]="showCodeMap['handler'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
    </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['handler']">
            <div class="range" #atHandler>
              <ngx-floating [at]="atHandler" [boundary]="atHandler" [movable]="true"
                            [handler]="'.drag-handle'"
                            [offset]="{ right: 10, bottom: 10, inner: true}">
                <div class="box">
                  <div class="drag-handle">🎮 拖拽这里（handler演示）</div>
                  <div>其他不可拖拽内容</div>
                </div>
              </ngx-floating>
            </div>
          </div>
          @if (showCodeMap['handler']) {
            <div class="example-code">
              <nz-code-editor [ngModel]="codeMap['handler']" [nzEditorOption]="{readOnly: true}"></nz-code-editor>
            </div>
          }
        </section>
      </nz-card>
    </nz-tab>
    <nz-tab nzTitle="高级用法">
      <nz-card class="demo-card">
        <section class="example">
          <div class="example-title">
            <h3>模板引用方式</h3>
            <span class="code-toggle" (click)="toggleCode('template')">
              <i nz-icon [nzType]="showCodeMap['template'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['template']">
            <div class="range" #atTemplate>
              <ng-template #floatingContent>
                <div class="box">使用ng-template的浮动内容</div>
              </ng-template>
              <ngx-floating [at]="atTemplate" [boundary]="atTemplate" [movable]="true" [content]="floatingContent"
                           [offset]="{ top: 10, left: 10, inner: true }">
              </ngx-floating>
            </div>
          </div>
          @if (showCodeMap['template']) {
            <div class="example-code">
              <nz-code-editor [ngModel]="codeMap['template']" [nzEditorOption]="{readOnly: true}"></nz-code-editor>
            </div>
          }
        </section>
        <section class="example">
          <div class="example-title">
            <h3>组件引用方式</h3>
            <span class="code-toggle" (click)="toggleCode('component')">
              <i nz-icon [nzType]="showCodeMap['component'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['component']">
            <div class="range" #atComponent>
              <ngx-floating [at]="atComponent" [boundary]="atComponent" [movable]="true" [content]="content"
                           [offset]="{ bottom: 10, right: 10, inner: true }">
              </ngx-floating>
            </div>
          </div>
          @if (showCodeMap['component']) {
            <div class="example-code">
              <nz-code-editor [ngModel]="codeMap['component']" [nzEditorOption]="{readOnly: true}"></nz-code-editor>
            </div>
          }
        </section>
      </nz-card>
    </nz-tab>
    <nz-tab nzTitle="指令用法">
      <nz-card class="demo-card">
        <section class="example">
          <div class="example-title">
            <h3>指令用法</h3>
            <span class="code-toggle" (click)="toggleCode('directive')">
              <i nz-icon [nzType]="showCodeMap['directive'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['directive']">
            <div class="range" #directiveTarget>
              <div class="box" [ngxFloating]="isMovable" [at]="directiveTarget"
                   [offset]="offset" [ignoreBoundary]="ignoreBoundary"
                   [handler]="'#directiveHandle'">
                <div id="directiveHandle" style="cursor: move; background: #f0f0f0; padding: 8px;">
                  🖱️ 指令拖拽区域
                </div>
                <div>内容区域（不可拖拽）</div>
              </div>
              <div class="box" [ngxFloating]="isMovable" [at]="directiveTarget" [offset]="offset"
                   [ignoreBoundary]="ignoreBoundary">
                使用指令的浮动元素
              </div>
              <div class="controls">
                <button nz-button nzType="default" (click)="isMovable = !isMovable">
                  {{ isMovable ? '禁用' : '启用' }}移动
                </button>
                <button nz-button nzType="default" (click)="ignoreBoundary = !ignoreBoundary">
                  {{ ignoreBoundary ? '启用' : '禁用' }}边界约束
                </button>
              </div>
            </div>
          </div>
          @if (showCodeMap['directive']) {
            <nz-code-editor [nzEditorOption]="{ language: 'html' }" [ngModel]="codeMap.directive" [disabled]="true"></nz-code-editor>
          }
        </section>
      </nz-card>
    </nz-tab>

    <nz-tab nzTitle="服务用法">
      <nz-card class="demo-card">
        <section class="example">
          <div class="example-title">
            <h3>服务用法</h3>
            <span class="code-toggle" (click)="toggleCode('service')">
              <i nz-icon [nzType]="showCodeMap['service'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['service']">
            <div class="range" #atService>
              <div class="controls">
                <button nz-button nzType="default" (click)="createByService(atService)">创建浮动内容</button>
                <button nz-button nzType="default" (click)="controlServiceFloating('show')">显示</button>
                <button nz-button nzType="default" (click)="controlServiceFloating('hide')">隐藏</button>
                <button nz-button nzType="default" (click)="controlServiceFloating('reset')">重置</button>
                <button nz-button nzType="default" (click)="controlServiceFloating('updatePosition')">更新位置</button>
              </div>
            </div>
          </div>
          @if (showCodeMap['service']) {
            <nz-code-editor [nzEditorOption]="{ language: 'html' }" [ngModel]="codeMap.service" [disabled]="true"></nz-code-editor>
          }
        </section>
      </nz-card>
    </nz-tab>

    <nz-tab nzTitle="位置控制">
      <nz-card class="demo-card">
        <section class="example">
          <div class="example-title">
            <h3>位置控制</h3>
            <span class="code-toggle" (click)="toggleCode('position')">
              <i nz-icon [nzType]="showCodeMap['position'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['position']">
            <h4>内部定位</h4>
            <div class="range" #atPosition>
              <ngx-floating [at]="atPosition" [boundary]="atPosition" [offset]="{ top: 10, left: 10 , inner:true}">
                <div class="box">左上角</div>
              </ngx-floating>
              <ngx-floating [at]="atPosition" [boundary]="atPosition" [offset]="{ top: 10, right: 10, inner:true }">
                <div class="box">右上角</div>
              </ngx-floating>
              <ngx-floating [at]="atPosition" [boundary]="atPosition" [offset]="{ bottom: 10, left: 10 , inner:true}">
                <div class="box">左下角</div>
              </ngx-floating>
              <ngx-floating [at]="atPosition" [boundary]="atPosition" [offset]="{ bottom: 10, right: 10 , inner:true}">
                <div class="box">右下角</div>
              </ngx-floating>
            </div>
            <h4>外部定位</h4>
            <div class="range" [style.width.%]="currentOuterWidth">
              <div class="point" #atRelative></div>
              <ngx-floating [at]="atRelative" [offset]="{ top: -50, left: -200 }">
                <div class="box">相对于左上角</div>
              </ngx-floating>
              <ngx-floating [at]="atRelative" [offset]="{ top: -50, right: 200}">
                <div class="box">相对于右上角</div>
              </ngx-floating>
              <ngx-floating [at]="atRelative" [offset]="{ bottom: 50, left: -200 }">
                <div class="box">相对于左下角</div>
              </ngx-floating>
              <ngx-floating [at]="atRelative" [offset]="{ bottom: 50, right: 200 }">
                <div class="box">相对于右下角</div>
              </ngx-floating>
            </div>
            <nz-slider [(ngModel)]="currentOuterWidth" [nzMin]="0" [nzMax]="100"></nz-slider>
          </div>
          @if (showCodeMap['position']) {
            <nz-code-editor [nzEditorOption]="{ language: 'html' }" [ngModel]="codeMap.position" [disabled]="true"></nz-code-editor>
          }
        </section>
      </nz-card>
    </nz-tab>

    <nz-tab nzTitle="自定义样式">
      <nz-card class="demo-card">
        <section class="example">
          <div class="example-title">
            <h3>自定义样式</h3>
            <span class="code-toggle" (click)="toggleCode('custom')">
              <i nz-icon [nzType]="showCodeMap['custom'] ? 'eye-invisible' : 'eye'" nzTheme="outline"></i>
            </span>
          </div>
          <div class="example-content" [hidden]="showCodeMap['custom']">
            <div class="range" #atCustom>
              <ngx-floating #floatingCustom [at]="atCustom" [offset]="{ top: 50, left: 50 , inner: true}"
                            class="custom-floating">
                <div class="box custom">
                  <h4>自定义样式</h4>
                  <p>可以通过CSS自定义浮动组件的样式</p>
                </div>
              </ngx-floating>
              <div class="controls">
                <button nz-button nzType="default"
                        (click)="floatingCustom.movable = !floatingCustom.movable; ">{{ floatingCustom.movable ? "关闭" : "开启" }}
                  移动
                </button>
                <button nz-button nzType="default"
                        (click)="toggleFloatingCustomBoundary(floatingCustom,atCustom)">{{ floatingCustom.hasBoundary ? "关闭" : "开启" }}
                  边界
                </button>
                <button nz-button nzType="default" (click)="floatingCustom.show()">显示</button>
                <button nz-button nzType="default" (click)="floatingCustom.hide()">隐藏</button>
                <button nz-button nzType="default" (click)="floatingCustom.reset()">重置</button>
              </div>
            </div>
          </div>
          @if (showCodeMap['custom']) {
            <nz-code-editor [nzEditorOption]="{ language: 'html' }" [ngModel]="codeMap.custom" [disabled]="true"></nz-code-editor>
          }
        </section>
      </nz-card>
    </nz-tab>

  </nz-tabset>

  <nz-card class="api-card">
    <section class="api">
      <div class="api-title">
        <h3>组件 API</h3>
      </div>
      <div class="api-content">
        <h4>属性</h4>
        <table>
          <thead>
          <tr>
            <th>属性名</th>
            <th>类型</th>
            <th>默认值</th>
            <th>说明</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>at</td>
            <td>HTMLElement</td>
            <td>必填</td>
            <td>目标定位元素</td>
          </tr>
          <tr>
            <td>handler</td>
            <td>string | HTMLElement</td>
            <td>undefined</td>
            <td>拖拽句柄元素选择器或DOM元素，未设置时整个组件可拖拽</td>
          </tr>
          <tr>
            <td>movable</td>
            <td>boolean</td>
            <td>false</td>
            <td>是否可拖拽</td>
          </tr>
          <tr>
            <td>offset</td>
            <td>FloatingOffset</td>
            <td>&#123; top: 0 &#125;</td>
            <td>位置偏移配置</td>
          </tr>
          <tr>
            <td>boundary</td>
            <td>HTMLElement</td>
            <td>documentElement</td>
            <td>移动边界元素</td>
          </tr>
          <tr>
            <td>ignoreBoundary</td>
            <td>boolean</td>
            <td>false</td>
            <td>是否忽略边界约束</td>
          </tr>
          <tr>
            <td>zIndex</td>
            <td>number</td>
            <td>2</td>
            <td>浮动元素的层级</td>
          </tr>
          <tr>
            <td>isVisible</td>
            <td>boolean</td>
            <td>true</td>
            <td>控制可见性</td>
          </tr>
          </tbody>
        </table>

        <h4>方法</h4>
        <table>
          <thead>
          <tr>
            <th>方法名</th>
            <th>说明</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>show()</td>
            <td>显示浮动元素</td>
          </tr>
          <tr>
            <td>hide()</td>
            <td>隐藏浮动元素</td>
          </tr>
          <tr>
            <td>reset()</td>
            <td>重置位置到初始状态</td>
          </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="api">
      <div class="api-title">
        <h3>服务 API</h3>
      </div>
      <div class="api-content">
        <h4>方法</h4>
        <table>
          <thead>
          <tr>
            <th>方法名</th>
            <th>参数</th>
            <th>说明</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>create</td>
            <td>(id: string, options: NgxFloatingServiceOptions)</td>
            <td>创建浮动实例</td>
          </tr>
          <tr>
            <td>destroy</td>
            <td>(id: string)</td>
            <td>销毁浮动实例</td>
          </tr>
          <tr>
            <td>show</td>
            <td>(id: string)</td>
            <td>显示浮动元素</td>
          </tr>
          <tr>
            <td>hide</td>
            <td>(id: string)</td>
            <td>隐藏浮动元素</td>
          </tr>
          <tr>
            <td>reset</td>
            <td>(id: string)</td>
            <td>重置位置到初始状态</td>
          </tr>
          <tr>
            <td>get</td>
            <td>(id: string)</td>
            <td>获取浮动实例</td>
          </tr>
          </tbody>
        </table>
      </div>
    </section>
  </nz-card>

</div>
